<svg height="504px" version="1.1" viewBox="-0.5 -0.5 770 504" width="770px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs/><rect height="30" class="none-stroke" width="360" x="408" y="172"/><foreignObject class="leftdiv" ><div class="flexcenter flexzero" style="width:358px;padding-top:187px;margin-left:409px" xmlns="http://www.w3.org/1999/xhtml"><div class="centerdiv"><div style='display:inline-block;font-size:15px;line-height:1.2;white-space:normal;overflow-wrap:normal;'>Context</div></div></div></foreignObject><path d="M 392.03 217 L 388 217 L 388 75 L 292.47 75" class="none-stroke" stroke-miterlimit="10" stroke-width="2"/><path d="M 406.03 217 L 399.03 221.12 L 392.03 217 L 399.03 212.88 Z" class="none-stroke" stroke-miterlimit="10" stroke-width="2"/><path d="M 298.24 71 L 290.24 75 L 298.24 79" class="none-stroke" stroke-miterlimit="10" stroke-width="2"/><rect height="30" class="none-stroke" width="360" x="408" y="202"/><foreignObject class="leftdiv" ><div class="flexstart flexzero" style="width:358px;padding-top:217px;margin-left:410px" xmlns="http://www.w3.org/1999/xhtml"><div class="leftdiv"><div class="normaldiv">- uniqueState</div></div></div></foreignObject><path d="M 392.03 247 L 282.47 247" class="none-stroke" stroke-miterlimit="10" stroke-width="2"/><path d="M 406.03 247 L 399.03 251.12 L 392.03 247 L 399.03 242.88 Z" class="none-stroke" stroke-miterlimit="10" stroke-width="2"/><path d="M 288.24 243 L 280.24 247 L 288.24 251" class="none-stroke" stroke-miterlimit="10" stroke-width="2"/><rect height="30" class="none-stroke" width="360" x="408" y="232"/><foreignObject class="leftdiv" ><div class="flexstart flexzero" style="width:358px;padding-top:247px;margin-left:410px" xmlns="http://www.w3.org/1999/xhtml"><div class="leftdiv"><div class="normaldiv">- flyweight</div></div></div></foreignObject><path d="M 405 277 Q 333 277 332.95 377.04" class="none-stroke" stroke-dasharray="6 6" stroke-miterlimit="10" stroke-width="2"/><ellipse cx="408" cy="277" fill="none" rx="3" ry="3" stroke="gray" stroke-width="2"/><rect height="30" class="none-stroke" width="360" x="408" y="262"/><foreignObject class="leftdiv" ><div class="flexstart flexzero" style="width:358px;padding-top:277px;margin-left:410px" xmlns="http://www.w3.org/1999/xhtml"><div class="leftdiv"><div class="normaldiv">+ Context(repeatingState, uniqueState)</div></div></div></foreignObject><rect height="30" class="none-stroke" width="360" x="408" y="292"/><foreignObject class="leftdiv" ><div class="flexstart flexzero" style="width:358px;padding-top:307px;margin-left:410px" xmlns="http://www.w3.org/1999/xhtml"><div class="leftdiv"><div class="normaldiv">+ operation()</div></div></div></foreignObject><path d="M 278 382 L 618 382 L 628 392 L 628 462 L 278 462 L 278 382 Z" class="fill-stroke" stroke-miterlimit="10"/><path d="M 618 382 L 618 392 L 628 392 Z" fill="#000000" fill-opacity="0.05" stroke="none"/><path d="M 618 382 L 618 392 L 628 392" class="none-stroke" stroke-miterlimit="10"/><foreignObject class="leftdiv" ><div class="flexstart flexzero" style="width:348px;padding-top:422px;margin-left:280px" xmlns="http://www.w3.org/1999/xhtml"><div class="leftdiv"><div class="normaldiv">this.uniqueState = uniqueState<br/>this.flyweight =<br/>factory.getFlyweight(repeatingState)</div></div></div></foreignObject><path d="M 458 472 L 758 472 L 768 482 L 768 502 L 458 502 L 458 472 Z" class="fill-stroke" stroke-miterlimit="10"/><path d="M 758 472 L 758 482 L 768 482 Z" fill="#000000" fill-opacity="0.05" stroke="none"/><path d="M 758 472 L 758 482 L 768 482" class="none-stroke" stroke-miterlimit="10"/><foreignObject class="leftdiv" ><div class="flexstart flexzero" style="width:308px;padding-top:487px;margin-left:460px" xmlns="http://www.w3.org/1999/xhtml"><div class="leftdiv"><div class="normaldiv">flyweight.operation(uniqueState)</div></div></div></foreignObject><path d="M 537.96 313 Q 538 335 603 335 Q 668 335 668 470" class="none-stroke" stroke-dasharray="6 6" stroke-miterlimit="10" stroke-width="2"/><ellipse cx="537.96" cy="310" fill="none" rx="3" ry="3" stroke="gray" stroke-width="2"/><rect height="30" class="none-stroke" width="280" x="8" y="0"/><foreignObject class="leftdiv" ><div class="flexcenter flexzero" style="width:278px;padding-top:15px;margin-left:9px" xmlns="http://www.w3.org/1999/xhtml"><div class="centerdiv"><div class="normaldiv">FlyweightFactory<br/></div></div></div></foreignObject><rect height="30" class="none-stroke" width="280" x="8" y="30"/><foreignObject class="leftdiv" ><div class="flexstart flexzero" style="width:278px;padding-top:45px;margin-left:10px" xmlns="http://www.w3.org/1999/xhtml"><div class="leftdiv"><div class="normaldiv"><div style="">- cache:Flyweight[]</div></div></div></div></foreignObject><path d="M 15 105.97 L 15 227.53" class="none-stroke" stroke-miterlimit="10" stroke-width="2"/><path d="M 15 91.97 L 19.12 98.97 L 15 105.97 L 10.88 98.97 Z" class="none-stroke" stroke-miterlimit="10" stroke-width="2"/><path d="M 11 221.76 L 15 229.76 L 19 221.76" class="none-stroke" stroke-miterlimit="10" stroke-width="2"/><rect height="30" class="none-stroke" width="280" x="8" y="60"/><foreignObject class="leftdiv" ><div class="flexstart flexzero" style="width:278px;padding-top:75px;margin-left:10px" xmlns="http://www.w3.org/1999/xhtml"><div class="leftdiv"><div class="normaldiv"><div style="">+ getFlyweight(repeatingState)</div></div></div></div></foreignObject><rect height="30" class="none-stroke" width="270" x="8" y="232"/><foreignObject class="leftdiv" ><div class="flexcenter flexzero" style="width:268px;padding-top:247px;margin-left:9px" xmlns="http://www.w3.org/1999/xhtml"><div class="centerdiv"><div class="normaldiv">Flyweight<br/></div></div></div></foreignObject><rect height="30" class="none-stroke" width="270" x="8" y="262"/><foreignObject class="leftdiv" ><div class="flexstart flexzero" style="width:268px;padding-top:277px;margin-left:10px" xmlns="http://www.w3.org/1999/xhtml"><div class="leftdiv"><div class="normaldiv"><div style="">- repeatingState</div></div></div></div></foreignObject><rect height="30" class="none-stroke" width="270" x="8" y="292"/><foreignObject class="leftdiv" ><div class="flexstart flexzero" style="width:268px;padding-top:307px;margin-left:10px" xmlns="http://www.w3.org/1999/xhtml"><div class="leftdiv"><div class="normaldiv"><div style="">+ operation(uniqueState)</div></div></div></div></foreignObject><path d="M 588 90.97 L 588 167.53" class="none-stroke" stroke-miterlimit="10" stroke-width="2"/><path d="M 588 76.97 L 592.12 83.97 L 588 90.97 L 583.88 83.97 Z" fill="gray" stroke="gray" stroke-miterlimit="10" stroke-width="2"/><path d="M 584 161.76 L 588 169.76 L 592 161.76" class="none-stroke" stroke-miterlimit="10" stroke-width="2"/><rect height="60" class="none-stroke" width="160" x="508" y="15"/><foreignObject class="leftdiv" ><div class="flexcenter flexzero" style="width:158px;padding-top:45px;margin-left:509px" xmlns="http://www.w3.org/1999/xhtml"><div class="centerdiv"><div class="normaldiv">Client<br/></div></div></div></foreignObject><path d="M 26 100 L 366 100 L 376 110 L 376 220 L 26 220 L 26 100 Z" class="fill-stroke" stroke-miterlimit="10"/><path d="M 366 100 L 366 110 L 376 110 Z" fill="#000000" fill-opacity="0.05" stroke="none"/><path d="M 366 100 L 366 110 L 376 110" class="none-stroke" stroke-miterlimit="10"/><foreignObject class="leftdiv" ><div class="flexstart flexzero" style="width:348px;padding-top:160px;margin-left:28px" xmlns="http://www.w3.org/1999/xhtml"><div class="leftdiv"><div class="normaldiv">if (cache[repeatingState] == null) {<br/>cache[repeatingState] =<br/>new Flyweight(operatingState)<br/>}<br/><br/>return cache[repeatingState]</div></div></div></foreignObject></svg>
