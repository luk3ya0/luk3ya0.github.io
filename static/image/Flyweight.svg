<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg height="504" viewBox="-0.5 -0.5 770 504" width="770" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <defs>
  <style>
   @import url(https://fonts.googleapis.com/css?family=Fira+Code);
  </style>
  <style>
   svg {
           color: gray; 
           font-size: 14px; 
           font-family: "Fira Code";
       } 
       .none-stroke {
           fill: none; 
           stroke: gray;
       } 
       .fill-stroke {
           fill: #333; 
           stroke: gray;
       } 
       foreignObject {
           width: 100%; 
           height: 100%;
       } 
       .leftdiv {
           overflow: visible; 
           text-align: left;
       } 
       .centerdiv {
           box-sizing:border-box; 
           text-align:center
       } 
       .normaldiv {
           display:inline-block; 
           line-height:1.2; 
           white-space:normal; 
           overflow-wrap:normal
       } 
       .flexcenter {
           display:flex; 
           align-items:unsafe center; 
           justify-content:unsafe center;
       }
       .flexstart {
           display:flex; 
           align-items:unsafe center; 
           justify-content:unsafe flex-start;
       } 
       .flexzero {height: 1px;}
  </style>
 </defs>
 <path d="M408 172h360v30H408z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:358px;height:1px;padding-top:187px;margin-left:409px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: rgb(0, 0, 0);" style="box-sizing:border-box;font-size:0;text-align:center">
    <div style='display:inline-block;font-size:15px;font-family:"Fira Code";color:#000;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal'>
     <font color="gray" data-font-src="https://fonts.googleapis.com/css?family=Fira+Code" style="font-size:15px">
      Context
     </font>
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M392.03 217H388V75h-95.53" fill="none" pointer-events="stroke" stroke="gray" stroke-miterlimit="10" stroke-width="2"/>
 <path d="m406.03 217-7 4.12-7-4.12 7-4.12ZM298.24 71l-8 4 8 4" fill="none" pointer-events="all" stroke="gray" stroke-miterlimit="10" stroke-width="2"/>
 <path d="M408 202h360v30H408z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe flex-start;width:358px;height:1px;padding-top:217px;margin-left:410px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: #808080;" style="box-sizing:border-box;font-size:0;text-align:left">
    <div style='display:inline-block;font-size:15px;font-family:"Fira Code";color:gray;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal'>
     - uniqueState
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M392.03 247H282.47" fill="none" pointer-events="stroke" stroke="gray" stroke-miterlimit="10" stroke-width="2"/>
 <path d="m406.03 247-7 4.12-7-4.12 7-4.12ZM288.24 243l-8 4 8 4" fill="none" pointer-events="all" stroke="gray" stroke-miterlimit="10" stroke-width="2"/>
 <path d="M408 232h360v30H408z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe flex-start;width:358px;height:1px;padding-top:247px;margin-left:410px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: #808080;" style="box-sizing:border-box;font-size:0;text-align:left">
    <div style='display:inline-block;font-size:15px;font-family:"Fira Code";color:gray;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal'>
     - flyweight
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M405 277q-72 0-72.05 100.04" fill="none" pointer-events="stroke" stroke="gray" stroke-dasharray="6 6" stroke-miterlimit="10" stroke-width="2"/>
 <circle cx="408" cy="277" fill="none" pointer-events="all" r="3" stroke="gray" stroke-width="2"/>
 <path d="M408 262h360v30H408z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe flex-start;width:358px;height:1px;padding-top:277px;margin-left:410px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: #808080;" style="box-sizing:border-box;font-size:0;text-align:left">
    <div style='display:inline-block;font-size:15px;font-family:"Fira Code";color:gray;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal'>
     + Context(repeatingState, uniqueState)
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M408 292h360v30H408z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe flex-start;width:358px;height:1px;padding-top:307px;margin-left:410px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: #808080;" style="box-sizing:border-box;font-size:0;text-align:left">
    <div style='display:inline-block;font-size:15px;font-family:"Fira Code";color:gray;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal'>
     + operation()
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M278 382h340l10 10v70H278v-80Z" fill="#333" pointer-events="all" stroke="gray" stroke-miterlimit="10"/>
 <path d="M618 382v10h10Z" fill-opacity=".05" pointer-events="all"/>
 <path d="M618 382v10h10" fill="none" pointer-events="all" stroke="gray" stroke-miterlimit="10"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe flex-start;width:348px;height:1px;padding-top:422px;margin-left:280px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: #808080;" style="box-sizing:border-box;font-size:0;text-align:left">
    <div style='display:inline-block;font-size:15px;font-family:"Fira Code";color:gray;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal'>
     this.uniqueState = uniqueState
     <br/>
     this.flyweight =
     <br/>
     factory.getFlyweight(repeatingState)
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M458 472h300l10 10v20H458v-30Z" fill="#333" pointer-events="all" stroke="gray" stroke-miterlimit="10"/>
 <path d="M758 472v10h10Z" fill-opacity=".05" pointer-events="all"/>
 <path d="M758 472v10h10" fill="none" pointer-events="all" stroke="gray" stroke-miterlimit="10"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe flex-start;width:308px;height:1px;padding-top:487px;margin-left:460px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: #808080;" style="box-sizing:border-box;font-size:0;text-align:left">
    <div style='display:inline-block;font-size:15px;font-family:"Fira Code";color:gray;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal'>
     flyweight.operation(uniqueState)
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M537.96 313q.04 22 65.04 22t65 135" fill="none" pointer-events="stroke" stroke="gray" stroke-dasharray="6 6" stroke-miterlimit="10" stroke-width="2"/>
 <circle cx="537.96" cy="310" fill="none" pointer-events="all" r="3" stroke="gray" stroke-width="2"/>
 <path d="M8 0h280v30H8z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:278px;height:1px;padding-top:15px;margin-left:9px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: rgb(0, 0, 0);" style="box-sizing:border-box;font-size:0;text-align:center">
    <div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal">
     <font color="gray" face="Fira Code">
      <span style="font-size:15px">
       FlyweightFactory
       <br/>
      </span>
     </font>
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M8 30h280v30H8z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe flex-start;width:278px;height:1px;padding-top:45px;margin-left:10px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: rgb(0, 0, 0);" style="box-sizing:border-box;font-size:0;text-align:left">
    <div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal">
     <div>
      <font color="gray" face="Fira Code">
       <span style="font-size:15px">
        - cache: Flyweight[]
       </span>
      </font>
     </div>
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M15 105.97v121.56" fill="none" pointer-events="stroke" stroke="gray" stroke-miterlimit="10" stroke-width="2"/>
 <path d="m15 91.97 4.12 7-4.12 7-4.12-7ZM11 221.76l4 8 4-8" fill="none" pointer-events="all" stroke="gray" stroke-miterlimit="10" stroke-width="2"/>
 <path d="M8 60h280v30H8z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe flex-start;width:278px;height:1px;padding-top:75px;margin-left:10px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: rgb(0, 0, 0);" style="box-sizing:border-box;font-size:0;text-align:left">
    <div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal">
     <div>
      <font color="gray" face="Fira Code">
       <span style="font-size:15px">
        + getFlyweight(repeatingState)
       </span>
      </font>
     </div>
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M8 232h270v30H8z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:268px;height:1px;padding-top:247px;margin-left:9px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: rgb(0, 0, 0);" style="box-sizing:border-box;font-size:0;text-align:center">
    <div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal">
     <font color="gray" face="Fira Code">
      <span style="font-size:15px">
       Flyweight
       <br/>
      </span>
     </font>
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M8 262h270v30H8z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe flex-start;width:268px;height:1px;padding-top:277px;margin-left:10px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: rgb(0, 0, 0);" style="box-sizing:border-box;font-size:0;text-align:left">
    <div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal">
     <div>
      <font color="gray" face="Fira Code">
       <span style="font-size:15px">
        - repeatingState
       </span>
      </font>
     </div>
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M8 292h270v30H8z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe flex-start;width:268px;height:1px;padding-top:307px;margin-left:10px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: rgb(0, 0, 0);" style="box-sizing:border-box;font-size:0;text-align:left">
    <div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal">
     <div>
      <font color="gray" face="Fira Code">
       <span style="font-size:15px">
        + operation(uniqueState)
       </span>
      </font>
     </div>
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M588 90.97v76.56" fill="none" pointer-events="stroke" stroke="gray" stroke-miterlimit="10" stroke-width="2"/>
 <path d="m588 76.97 4.12 7-4.12 7-4.12-7Z" fill="gray" pointer-events="all" stroke="gray" stroke-miterlimit="10" stroke-width="2"/>
 <path d="m584 161.76 4 8 4-8" fill="none" pointer-events="all" stroke="gray" stroke-miterlimit="10" stroke-width="2"/>
 <path d="M508 15h160v60H508z" fill="none" pointer-events="all" stroke="gray"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe center;width:158px;height:1px;padding-top:45px;margin-left:509px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: rgb(0, 0, 0);" style="box-sizing:border-box;font-size:0;text-align:center">
    <div style="display:inline-block;font-size:12px;font-family:Helvetica;color:#000;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal">
     <font color="gray" face="Fira Code">
      <span style="font-size:15px">
       Client
       <br/>
      </span>
     </font>
    </div>
   </div>
  </div>
 </foreignObject>
 <path d="M26 100h340l10 10v110H26V100Z" fill="#333" pointer-events="all" stroke="gray" stroke-miterlimit="10"/>
 <path d="M366 100v10h10Z" fill-opacity=".05" pointer-events="all"/>
 <path d="M366 100v10h10" fill="none" pointer-events="all" stroke="gray" stroke-miterlimit="10"/>
 <foreignObject height="100%" pointer-events="none" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow:visible;text-align:left" width="100%">
  <div style="display:flex;align-items:unsafe center;justify-content:unsafe flex-start;width:348px;height:1px;padding-top:160px;margin-left:28px" xmlns="http://www.w3.org/1999/xhtml">
   <div data-drawio-colors="color: #808080;" style="box-sizing:border-box;font-size:0;text-align:left">
    <div style='display:inline-block;font-size:15px;font-family:"Fira Code";color:gray;line-height:1.2;pointer-events:all;white-space:normal;overflow-wrap:normal'>
     if (cache[repeatingState] == null) {
     <br/>
     cache[repeatingState] =
     <br/>
     new Flyweight(operatingState)
     <br/>
     }
     <br/>
     <br/>
     return cache[repeatingState]
    </div>
   </div>
  </div>
 </foreignObject>
</svg>